<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>DiploF√°cil - UNICV</title>
    <meta name="theme-color" content="#047857">

    <link rel="manifest" href="manifest.json">
    <link rel="apple-touch-icon" href="https://cdn-icons-png.flaticon.com/512/3233/3233504.png">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Lexend:wght@300;400;600;700;800;900&display=swap');
        
        :root {
            --law-primary: #047857; 
            --law-action: #f97316; 
            --law-bg: #f8fafc; 
        }
        body { font-family: 'Lexend', sans-serif; background-color: var(--law-bg); -webkit-tap-highlight-color: transparent; overflow-x: hidden; }
        .bg-law-primary { background-color: var(--law-primary); }
        .text-law-primary { color: var(--law-primary); }
        .bg-law-action { background-color: var(--law-action); }
        .text-law-action { color: var(--law-action); }

        .screen { display: none; animation: fadeIn 0.2s ease-out; }
        .screen.active { display: block; }
        
        .deep-screen {
            position: fixed; inset: 0; background: var(--law-bg); z-index: 200;
            transform: translateX(100%); transition: transform 0.3s cubic-bezier(0.16, 1, 0.3, 1);
            overflow-y: auto; display: flex; flex-direction: column;
        }
        .deep-screen.open { transform: translateX(0); }

        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
        @keyframes popIn { 0% { transform: scale(0.9); opacity: 0; } 100% { transform: scale(1); opacity: 1; } }
        @keyframes shake { 0%, 100% { transform: translateX(0); } 25% { transform: translateX(-8px); } 75% { transform: translateX(8px); } }
        @keyframes pulse-scale { 0%, 100% { transform: scale(1); } 50% { transform: scale(1.1); } }

        .btn-3d { transition: all 0.1s; border-bottom-width: 5px; }
        .btn-3d:active { transform: translateY(3px); border-bottom-width: 0px; margin-bottom: 5px; }
        .shake-error { animation: shake 0.4s ease-in-out; border-color: #ef4444 !important; background-color: #fef2f2 !important; color: #b91c1c !important; }
        .correct-answer { border-color: #10b981 !important; background-color: #ecfdf5 !important; color: #047857 !important; }

        .glass-panel { background: rgba(255, 255, 255, 0.95); backdrop-filter: blur(10px); }
        .no-scrollbar::-webkit-scrollbar { display: none; }
        
        .fab { position: fixed; bottom: 85px; right: 20px; z-index: 60; animation: float 3s ease-in-out infinite; }
        @keyframes float { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-8px); } }

        .calendar-grid { display: grid; grid-template-columns: repeat(7, 1fr); gap: 8px; }
        .cal-day { aspect-ratio: 1; border-radius: 12px; display: flex; align-items: center; justify-content: center; font-weight: bold; font-size: 14px; background: white; border: 2px solid #f1f5f9; box-shadow: 0 1px 2px rgba(0,0,0,0.05); }
        .cal-header { font-size: 10px; text-transform: uppercase; color: #94a3b8; font-weight: 800; text-align: center; margin-bottom: 4px; }
    </style>
</head>
<body class="text-slate-800 antialiased pb-24">

    <audio id="sfx-success" src="https://assets.mixkit.co/active_storage/sfx/2013/2013-preview.mp3"></audio>
    <audio id="sfx-error" src="https://assets.mixkit.co/active_storage/sfx/2955/2955-preview.mp3"></audio>
    <audio id="sfx-countdown" src="https://assets.mixkit.co/active_storage/sfx/2018/2018-preview.mp3"></audio>

    <div id="login-screen" class="fixed inset-0 bg-law-primary z-[300] flex flex-col justify-center px-8 bg-[url('https://www.transparenttextures.com/patterns/cubes.png')]">
        <div class="text-center mb-10">
            <div class="w-24 h-24 bg-white rounded-3xl mx-auto flex items-center justify-center shadow-2xl mb-6">
                <i class="fas fa-owl text-5xl text-law-primary"></i>
            </div>
            <h1 class="text-4xl font-black text-white tracking-tighter">DiploF√°cil</h1>
            <p class="text-green-100 font-medium mt-2">UNICV - 3¬∫ Semestre Noturno</p>
        </div>
        <div class="space-y-4">
            <input type="email" placeholder="E-mail (ex: bruno@unicv.edu.br)" class="w-full p-4 rounded-xl bg-white text-slate-800 font-bold focus:outline-none focus:ring-4 focus:ring-law-action shadow-lg">
            <input type="password" placeholder="Senha" class="w-full p-4 rounded-xl bg-white text-slate-800 font-bold focus:outline-none focus:ring-4 focus:ring-law-action shadow-lg">
            <button onclick="doLogin()" class="w-full py-4 mt-4 bg-law-action text-white font-black rounded-xl btn-3d border-[#c25a11] text-lg shadow-xl uppercase">ACESSAR PLATAFORMA</button>
        </div>
    </div>

    <div id="checkin-modal" class="fixed inset-0 bg-black/60 z-[250] hidden flex-col items-center justify-center px-5 backdrop-blur-sm">
        <div class="bg-white rounded-[2rem] p-6 shadow-2xl w-full max-w-sm" style="animation: popIn 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);">
            <div class="flex items-center gap-3 mb-4">
                <div class="w-12 h-12 bg-green-100 rounded-full flex items-center justify-center text-2xl border-2 border-green-200 overflow-hidden">
                    üë©‚Äçüè´
                </div>
                <div>
                    <span class="bg-law-primary text-white text-[10px] font-black px-2 py-0.5 rounded-md uppercase">Check-in Di√°rio</span>
                    <h2 class="font-black text-xl text-slate-800">Ol√°, Bruno!</h2>
                </div>
            </div>
            <p class="text-slate-600 font-medium text-sm leading-relaxed mb-6">
                Como foi a aula de <b>Contratos</b> hoje? A professora Juliana fez aquela pergunta cl√°ssica <i class="text-law-action">"√â f√°cil, n√©?"</i> para a turma novamente?
            </p>
            <div class="space-y-3">
                <button onclick="answerCheckin('presente')" class="w-full py-3 bg-green-500 text-white font-bold rounded-xl btn-3d border-green-700 flex justify-between px-5 items-center">
                    <span>Fui e anotei o conte√∫do</span> <span class="bg-green-600 px-2 py-1 rounded text-xs">+50 XP</span>
                </button>
                <button onclick="answerCheckin('faltei')" class="w-full py-3 bg-red-50 text-red-600 font-bold rounded-xl border-2 border-red-100 hover:bg-red-100 transition-colors">
                    Acabei faltando hoje
                </button>
            </div>
        </div>
    </div>

    <div id="main-app" class="hidden">
        
        <header class="glass-panel fixed top-0 left-0 right-0 border-b border-gray-200 z-40 px-5 py-3 flex justify-between items-center shadow-sm">
            <div class="flex items-center gap-2">
                <div class="w-10 h-10 bg-law-primary rounded-xl flex items-center justify-center text-white"><i class="fas fa-owl"></i></div>
                <span class="text-xl font-black text-law-primary">DiploF√°cil</span>
            </div>
            <div id="xp-counter" class="flex items-center gap-1.5 bg-orange-100 px-3 py-1.5 rounded-xl font-black text-sm text-orange-800 transition-transform">
                <i class="fas fa-fire text-law-action"></i> <span>120 XP</span>
            </div>
        </header>

        <main id="screen-trilha" class="screen active pt-24 px-5">
            <div class="bg-law-primary rounded-3xl p-6 text-white mb-8 shadow-xl relative overflow-hidden">
                <div class="relative z-10">
                    <h2 class="text-2xl font-black mt-2 mb-2">Direito Contratual</h2>
                    <p class="text-xs font-bold text-green-100 mb-4">Prof¬™ Juliana ‚Ä¢ 3¬∫ Semestre</p>
                    <div class="w-full bg-black/20 rounded-full h-3"><div class="bg-law-action h-3 rounded-full" style="width: 20%"></div></div>
                </div>
                <i class="fas fa-file-signature absolute -right-4 -bottom-4 text-white/10 text-8xl rotate-12"></i>
            </div>

            <div class="flex flex-col items-center space-y-12 relative pb-4">
                <div class="absolute top-10 bottom-10 w-3 bg-gray-200 rounded-full -z-10"></div>

                <div class="flex flex-col items-center relative">
                    <div class="absolute -top-10 bg-law-action text-white px-4 py-1.5 rounded-full font-black text-[10px] uppercase shadow-lg animate-bounce">Praticar</div>
                    <button onclick="openDeepScreen('screen-quiz'); initQuiz();" class="btn-3d w-28 h-28 bg-law-primary rounded-full flex items-center justify-center border-b-[8px] border-[#024a35] text-white text-5xl shadow-2xl ring-8 ring-[var(--law-bg)]">
                        <i class="fas fa-play ml-1"></i>
                    </button>
                    <p class="font-black text-law-primary mt-4 text-base text-center">Teoria da Agni√ß√£o<br><span class="text-xs text-slate-400 font-bold uppercase">6 Quest√µes</span></p>
                </div>

                <div class="flex flex-col items-center opacity-60">
                    <div class="w-20 h-20 bg-slate-300 rounded-full flex items-center justify-center border-b-[6px] border-slate-400 text-slate-500 text-3xl">
                        <i class="fas fa-lock"></i>
                    </div>
                    <p class="font-bold text-slate-500 mt-2 text-xs uppercase">Evic√ß√£o e V√≠cios</p>
                </div>
            </div>
        </main>

        <main id="screen-faltas" class="screen pt-24 px-5">
            <h1 class="text-2xl font-black text-law-primary mb-2">Di√°rio de Faltas</h1>
            <p class="text-slate-500 text-sm font-medium mb-6">Acesse os resumos das aulas perdidas.</p>
            
            <div class="bg-white p-5 rounded-3xl shadow-sm border border-gray-200 mb-6">
                <div class="calendar-grid mb-2">
                    <div class="cal-header">D</div><div class="cal-header">S</div><div class="cal-header">T</div><div class="cal-header">Q</div><div class="cal-header">Q</div><div class="cal-header">S</div><div class="cal-header">S</div>
                    <div class="cal-day opacity-30">25</div><div class="cal-day opacity-30">26</div><div class="cal-day opacity-30">27</div><div class="cal-day opacity-30">28</div><div class="cal-day opacity-30">29</div><div class="cal-day opacity-30">30</div><div class="cal-day opacity-30">31</div>
                    <div class="cal-day">1</div><div class="cal-day">2</div><div class="cal-day">3</div><div class="cal-day">4</div><div class="cal-day">5</div><div class="cal-day">6</div><div class="cal-day">7</div>
                    <div class="cal-day">8</div><div class="cal-day">9</div><div class="cal-day">10</div>
                    
                    <div class="cal-day bg-red-50 border-red-200 text-red-600 relative cursor-pointer shadow-md" onclick="alert('Resumo de Ambiental em processamento.')">
                        11<div class="absolute -top-1 -right-1 w-3 h-3 bg-red-500 rounded-full border-2 border-white"></div>
                    </div>
                    
                    <div class="cal-day">12</div><div class="cal-day">13</div><div class="cal-day">14</div><div class="cal-day">15</div><div class="cal-day">16</div>
                    
                    <div class="cal-day bg-red-50 border-red-300 text-red-700 relative cursor-pointer shadow-md border-b-4 ring-2 ring-red-200" onclick="document.getElementById('resumo-falta').classList.remove('hidden')">
                        17<div class="absolute -top-1 -right-1 w-3 h-3 bg-red-500 rounded-full border-2 border-white animate-pulse"></div>
                    </div>
                    
                    <div class="cal-day bg-law-primary text-white border-law-primary">18</div><div class="cal-day">19</div><div class="cal-day">20</div><div class="cal-day">21</div>
                </div>
            </div>

            <div id="resumo-falta" class="bg-white rounded-3xl p-5 shadow-xl border-2 border-red-100 hidden">
                <div class="flex justify-between items-start mb-4">
                    <div>
                        <span class="bg-red-100 text-red-600 text-[10px] font-black px-2 py-1 rounded-full uppercase">Falta Registrada - 17/02</span>
                        <h3 class="font-black text-slate-800 text-lg mt-2">Nulidades (Contratos)</h3>
                    </div>
                    <div class="w-10 h-10 bg-law-primary text-white rounded-xl flex items-center justify-center"><i class="fas fa-gavel"></i></div>
                </div>
                
                <div class="bg-slate-50 p-3 rounded-xl border border-slate-100 mb-2">
                    <p class="text-[10px] font-black text-law-action uppercase mb-1">Quest√£o central da aula:</p>
                    <p class="text-sm font-bold text-slate-700">"Um contrato nulo pode ser validado com o passar do tempo?"</p>
                </div>
                <div class="bg-green-50 p-3 rounded-xl border border-green-100 flex gap-2 mb-6">
                    <i class="fas fa-robot text-law-primary mt-1"></i>
                    <p class="text-xs font-medium text-slate-600"><b>Resposta:</b> N√£o. A nulidade (Art. 166) fere a Ordem P√∫blica, portanto, o erro n√£o prescreve e n√£o pode ser validado. Apenas a Anulabilidade (Art. 171) pode ser sanada (convalescer) no prazo legal.</p>
                </div>
                <button onclick="openDeepScreen('screen-resumo-completo')" class="w-full py-4 bg-law-primary text-white font-black rounded-xl btn-3d border-[#024a35] shadow-md flex justify-center items-center gap-2">
                    <i class="fas fa-book-open"></i> LER RESUMO COMPLETO
                </button>
            </div>
        </main>

        <main id="screen-resumos" class="screen pt-24 px-5">
            <h1 class="text-2xl font-black text-law-primary mb-6">Materiais de Estudo</h1>
            
            <div class="space-y-4">
                <div class="bg-white p-4 rounded-3xl border-2 border-law-action shadow-sm relative overflow-hidden">
                    <div class="absolute top-0 left-0 w-2 h-full bg-law-action"></div>
                    <span class="bg-orange-100 text-law-action text-[9px] font-black px-2 py-0.5 rounded-md uppercase ml-3">√Åudio da Aula</span>
                    <h3 class="font-bold text-slate-800 mt-1 ml-3 mb-3">Gravado em sala - Prof¬™ Juliana</h3>
                    <iframe src="https://drive.google.com/file/d/1qQtEYkRNuk6P2oxYJkduGvFOhNbd0E5u/preview" width="100%" height="100" class="rounded-xl" allow="autoplay"></iframe>
                </div>

                <button onclick="openDeepScreen('screen-resumo-completo')" class="w-full text-left bg-white p-5 rounded-3xl border-2 border-law-primary shadow-md flex items-center gap-4 btn-3d active:transform-none transition-transform hover:scale-[1.02]">
                    <div class="w-12 h-12 bg-green-50 text-law-primary rounded-2xl flex items-center justify-center text-xl"><i class="fas fa-file-alt"></i></div>
                    <div class="flex-1">
                        <span class="bg-law-primary text-white text-[9px] font-black px-2 py-0.5 rounded-md uppercase mb-1 inline-block">Resumo Estruturado</span>
                        <h3 class="font-black text-slate-800 text-base">Contratos: Aula 1 e 2</h3>
                        <p class="text-[10px] text-slate-500 font-bold mt-1">Anota√ß√µes da lousa revisadas.</p>
                    </div>
                    <i class="fas fa-chevron-right text-law-primary"></i>
                </button>

                <h3 class="font-bold text-slate-500 text-xs uppercase tracking-widest mt-6 mb-2">Outras Mat√©rias (Premium)</h3>
                
                <button onclick="openPaywall()" class="w-full text-left bg-slate-50 p-4 rounded-2xl border border-gray-200 flex items-center gap-4 opacity-70">
                    <div class="w-10 h-10 bg-slate-200 text-slate-400 rounded-xl flex items-center justify-center"><i class="fas fa-tree"></i></div>
                    <div class="flex-1"><h3 class="font-bold text-slate-700">Ambiental e Urban√≠stico</h3></div>
                    <i class="fas fa-lock text-slate-400"></i>
                </button>
                <button onclick="openPaywall()" class="w-full text-left bg-slate-50 p-4 rounded-2xl border border-gray-200 flex items-center gap-4 opacity-70">
                    <div class="w-10 h-10 bg-slate-200 text-slate-400 rounded-xl flex items-center justify-center"><i class="fas fa-balance-scale"></i></div>
                    <div class="flex-1"><h3 class="font-bold text-slate-700">Teoria Geral do Processo</h3></div>
                    <i class="fas fa-lock text-slate-400"></i>
                </button>
            </div>
        </main>

        <main id="screen-simulados" class="screen pt-24 px-5">
            <h1 class="text-2xl font-black text-law-primary mb-2">Simulados e Pr√°tica</h1>
            <p class="text-slate-500 text-sm font-medium mb-6">Prepare-se para as avalia√ß√µes do semestre.</p>

            <div class="bg-law-primary p-6 rounded-3xl border-2 border-[#024a35] mb-8 shadow-xl text-white relative overflow-hidden">
                <i class="fas fa-file-contract absolute -right-4 -bottom-4 text-white/10 text-8xl rotate-12"></i>
                <div class="relative z-10">
                    <span class="bg-law-action text-white text-[10px] font-black px-2 py-1 rounded-full uppercase shadow-md">Liberado</span>
                    <h3 class="text-2xl font-black mt-3 mb-1">Direito Contratual</h3>
                    <p class="text-sm text-green-100 font-medium mb-6"><i class="fas fa-clock mr-1"></i> 10 quest√µes objetivas ‚Ä¢ Aula 1</p>
                    <button onclick="startCountdown()" class="w-full py-4 bg-white text-law-primary font-black rounded-xl btn-3d border-gray-300 shadow-lg flex justify-center items-center gap-2">
                        <i class="fas fa-play text-law-action"></i> INICIAR SIMULADO
                    </button>
                </div>
            </div>

            <h3 class="font-bold text-slate-500 text-xs uppercase tracking-widest mb-3">Simulados Completos (Premium)</h3>
            <div class="grid grid-cols-2 gap-3">
                <button onclick="openPaywall()" class="bg-white p-4 rounded-2xl border border-gray-200 text-center shadow-sm opacity-80">
                    <i class="fas fa-lock text-xl text-slate-300 mb-2"></i><h4 class="font-bold text-slate-700 text-sm">TGP</h4>
                </button>
                <button onclick="openPaywall()" class="bg-white p-4 rounded-2xl border border-gray-200 text-center shadow-sm opacity-80">
                    <i class="fas fa-lock text-xl text-slate-300 mb-2"></i><h4 class="font-bold text-slate-700 text-sm">Ambiental</h4>
                </button>
            </div>
        </main>

        <main id="screen-comunidade" class="screen pt-24 px-5">
            <h1 class="text-2xl font-black text-law-primary mb-6">Turma 3¬∫ Semestre</h1>
            
            <div class="grid grid-cols-2 gap-3 mb-8">
                <a href="#" onclick="openPaywall()" class="bg-slate-800 text-white p-4 rounded-2xl flex flex-col items-center justify-center text-center shadow-lg border-b-4 border-slate-900 active:translate-y-1 active:border-b-0 transition-all">
                    <i class="fab fa-whatsapp text-3xl text-law-action mb-2"></i>
                    <h3 class="font-black text-sm">Acesso VIP</h3>
                    <p class="text-[9px] text-slate-400 font-bold uppercase mt-1">Resumos Antecipados</p>
                </a>
                <a href="#" class="bg-white text-slate-700 p-4 rounded-2xl flex flex-col items-center justify-center text-center shadow-sm border-2 border-green-500 active:translate-y-1 active:border-b-0 transition-all">
                    <i class="fab fa-whatsapp text-3xl text-green-500 mb-2"></i>
                    <h3 class="font-black text-sm">Grupo da Sala</h3>
                    <p class="text-[9px] text-slate-400 font-bold uppercase mt-1">Avisos e Discuss√µes</p>
                </a>
            </div>

            <div class="flex justify-between items-end mb-3">
                <h3 class="font-bold text-slate-600 text-sm">Ranking de Estudos (XP)</h3>
            </div>
            
            <div class="bg-white border border-gray-200 rounded-3xl p-3 shadow-sm space-y-3">
                <div class="flex items-center gap-3 bg-orange-50 p-3 rounded-2xl border border-orange-200 relative">
                    <span class="font-black text-law-action text-lg w-5 text-center">1</span>
                    <div class="w-10 h-10 bg-law-action text-white rounded-full flex items-center justify-center font-bold">B</div>
                    <div class="flex-1">
                        <div class="flex items-center gap-2">
                            <h3 class="font-bold text-sm text-slate-800">Bruno</h3>
                            <span class="bg-law-primary text-white text-[8px] px-1.5 py-0.5 rounded font-black uppercase tracking-widest">Plano OAB</span>
                        </div>
                        <div class="w-full bg-orange-200 h-1.5 rounded-full mt-1.5"><div class="bg-law-action h-1.5 rounded-full" style="width: 100%"></div></div>
                    </div>
                    <span class="text-[10px] font-black text-law-action text-right">3.450<br>XP</span>
                </div>
                <div class="flex items-center gap-3 p-3">
                    <span class="font-bold text-slate-400 w-5 text-center">2</span>
                    <div class="w-10 h-10 bg-slate-200 text-slate-600 rounded-full flex items-center justify-center font-bold">J</div>
                    <div class="flex-1">
                        <div class="flex items-center gap-2">
                            <h3 class="font-bold text-sm text-slate-700">Jo√£o P.</h3>
                            <span class="bg-blue-500 text-white text-[8px] px-1.5 py-0.5 rounded font-black uppercase tracking-widest">PRO</span>
                        </div>
                        <div class="w-full bg-slate-200 h-1.5 rounded-full mt-1.5"><div class="bg-slate-400 h-1.5 rounded-full" style="width: 80%"></div></div>
                    </div>
                    <span class="text-[10px] font-bold text-slate-400 text-right">2.900<br>XP</span>
                </div>
            </div>
        </main>

        <nav class="glass-panel fixed bottom-0 left-0 right-0 border-t border-gray-200 pb-[env(safe-area-inset-bottom,20px)] z-30 px-2">
            <div class="flex justify-between items-center pt-2 pb-4">
                <button onclick="navigate('trilha')" class="nav-btn text-law-primary flex flex-col items-center gap-1 w-[20%]" data-target="trilha">
                    <i class="fas fa-route text-xl"></i><span class="text-[9px] font-black uppercase tracking-tighter">Trilha</span>
                </button>
                <button onclick="navigate('faltas')" class="nav-btn text-slate-400 flex flex-col items-center gap-1 w-[20%]" data-target="faltas">
                    <i class="fas fa-calendar-times text-xl"></i><span class="text-[9px] font-black uppercase tracking-tighter">Faltas</span>
                </button>
                <button onclick="navigate('resumos')" class="nav-btn text-slate-400 flex flex-col items-center gap-1 w-[20%]" data-target="resumos">
                    <i class="fas fa-headphones text-xl"></i><span class="text-[9px] font-black uppercase tracking-tighter">Resumos</span>
                </button>
                <button onclick="navigate('simulados')" class="nav-btn text-slate-400 flex flex-col items-center gap-1 w-[20%]" data-target="simulados">
                    <i class="fas fa-check-double text-xl"></i><span class="text-[9px] font-black uppercase tracking-tighter">Provas</span>
                </button>
                <button onclick="navigate('comunidade')" class="nav-btn text-slate-400 flex flex-col items-center gap-1 w-[20%]" data-target="comunidade">
                    <i class="fas fa-users text-xl"></i><span class="text-[9px] font-black uppercase tracking-tighter">Turma</span>
                </button>
            </div>
        </nav>

        <button onclick="document.getElementById('novidades-modal').classList.remove('hidden')" class="fab w-14 h-14 bg-law-action rounded-full shadow-[0_0_20px_rgba(249,115,22,0.6)] flex items-center justify-center text-white text-2xl border-2 border-white">
            <i class="fas fa-rocket"></i>
        </button>

    </div> 

    <div id="screen-quiz" class="deep-screen">
        <div class="px-5 py-4 flex items-center gap-4 bg-white border-b shadow-sm sticky top-0 z-10">
            <button onclick="closeDeepScreen('screen-quiz')" class="text-slate-400 text-2xl"><i class="fas fa-times"></i></button>
            <div class="flex-1 bg-slate-100 h-4 rounded-full overflow-hidden p-0.5">
                <div id="quiz-progress" class="bg-green-500 h-full w-[10%] rounded-full transition-all duration-300"></div>
            </div>
            <i class="fas fa-heart text-red-500 text-xl"></i>
        </div>
        
        <div class="flex-1 px-5 py-8 flex flex-col" id="quiz-container">
            <h2 class="text-2xl font-black text-slate-800 mb-8 leading-snug" id="quiz-question">O que caracteriza a forma√ß√£o de um contrato?</h2>
            
            <div class="space-y-4 w-full" id="quiz-options"></div>
            
            <div class="mt-auto pt-8">
                <button id="quiz-btn" onclick="checkAnswer()" class="w-full py-4 bg-slate-200 text-slate-400 font-black rounded-xl btn-3d pointer-events-none">VERIFICAR</button>
            </div>
        </div>

        <div id="quiz-success" class="hidden flex-1 flex-col items-center justify-center p-8 text-center">
            <div class="w-32 h-32 bg-green-100 rounded-full flex items-center justify-center mb-6 shadow-lg shadow-green-200">
                <i class="fas fa-check text-6xl text-green-500"></i>
            </div>
            <h2 class="text-3xl font-black text-law-primary mb-2">Resposta Correta!</h2>
            <p class="text-slate-500 font-bold mb-8">+100 XP adicionados ao seu progresso.</p>
            <button onclick="closeDeepScreen('screen-quiz')" class="w-full py-4 bg-law-primary text-white font-black rounded-xl btn-3d border-[#024a35]">VOLTAR √Ä TRILHA</button>
        </div>
    </div>

    <div id="screen-resumo-completo" class="deep-screen">
        <div class="px-5 py-4 flex items-center justify-between bg-law-primary text-white border-b border-[#024a35] sticky top-0 z-10 shadow-md">
            <button onclick="closeDeepScreen('screen-resumo-completo')" class="text-white text-2xl"><i class="fas fa-arrow-left"></i></button>
            <span class="font-black text-lg">Resumo Estruturado</span>
            <i class="fas fa-bookmark"></i>
        </div>
        
        <div class="p-6 bg-white flex-1">
            <span class="bg-orange-100 text-law-action text-[10px] font-black px-2 py-1 rounded-md uppercase">Aula 1 e 2</span>
            <h1 class="text-3xl font-black text-slate-800 mt-2 mb-6">Direito Contratual: Forma√ß√£o e Nulidades</h1>
            
            <p class="text-slate-600 font-medium leading-relaxed mb-6">O contrato √©, essencialmente, um acordo de vontades. Pense nele como uma ponte: de um lado, algu√©m quer oferecer; do outro, algu√©m quer aceitar. Quando essas vontades se encontram, nasce a obriga√ß√£o jur√≠dica (o <b>neg√≥cio jur√≠dico bilateral</b>).</p>

            <h3 class="font-black text-law-primary text-lg mb-3 flex items-center gap-2"><i class="fas fa-paper-plane text-law-action"></i> Forma√ß√£o (Teoria da Agni√ß√£o)</h3>
            <div class="bg-slate-50 p-4 rounded-2xl border border-slate-200 mb-6">
                <p class="text-sm text-slate-700">Como regra, o Brasil adota a <b>Teoria da Expedi√ß√£o</b> (Art. 434). Isso significa que, em contratos √† dist√¢ncia, o acordo passa a valer no exato momento em que a resposta de aceita√ß√£o √© enviada.<br><br><b>Exce√ß√µes (Quando enviar n√£o √© suficiente):</b><br>1. Retrata√ß√£o: Se o aviso de cancelamento da parte chegar antes ou junto com a aceita√ß√£o.<br>2. Compromisso de espera: Se quem prop√¥s o contrato exigiu que ele s√≥ valha ap√≥s receber a resposta.<br>3. Prazo: Se a resposta n√£o chegar no tempo combinado.</p>
            </div>

            <h3 class="font-black text-law-primary text-lg mb-3 flex items-center gap-2"><i class="fas fa-balance-scale-left text-law-action"></i> Nulidade vs Anulabilidade</h3>
            <table class="w-full text-left text-sm mb-6 border-collapse">
                <thead><tr class="bg-slate-100 text-slate-700 font-bold"><th class="p-3 rounded-tl-xl">Caracter√≠stica</th><th class="p-3">Nulidade (Art 166)</th><th class="p-3 rounded-tr-xl">Anulabilidade (Art 171)</th></tr></thead>
                <tbody>
                    <tr class="border-b border-slate-100"><td class="p-3 font-bold text-slate-600">Gravidade do Erro</td><td class="p-3 text-red-600 font-bold">Grave (Ordem P√∫blica)</td><td class="p-3 text-orange-500 font-bold">Leve (Interesse Privado)</td></tr>
                    <tr class="border-b border-slate-100"><td class="p-3 font-bold text-slate-600">A√ß√£o do Juiz</td><td class="p-3">Cancela por conta pr√≥pria</td><td class="p-3">S√≥ age se provocado</td></tr>
                    <tr><td class="p-3 font-bold text-slate-600 rounded-bl-xl">Prazo de Validade</td><td class="p-3">N√£o prescreve com o tempo</td><td class="p-3">Pode ser perdoado no prazo legal</td></tr>
                </tbody>
            </table>

            <h3 class="font-black text-law-primary text-lg mb-3 flex items-center gap-2"><i class="fas fa-house-damage text-law-action"></i> Evic√ß√£o e V√≠cios Redibit√≥rios</h3>
            <div class="bg-red-50 p-4 rounded-2xl border border-red-100 mb-8">
                <p class="text-sm text-slate-700 mb-3"><b>V√≠cio Redibit√≥rio:</b> √â um defeito oculto que prejudica o uso ou o valor do que voc√™ adquiriu. (Exemplo: Comprar um carro aparentemente perfeito, mas com o motor prestes a fundir).</p>
                <p class="text-sm text-slate-700"><b>Evic√ß√£o:</b> √â perder o bem que voc√™ adquiriu porque a Justi√ßa determinou que ele pertence a outra pessoa. (Exemplo: Comprar um terreno e descobrir depois que ele j√° tinha um dono leg√≠timo).</p>
            </div>
            
            <button onclick="closeDeepScreen('screen-resumo-completo')" class="w-full py-4 bg-slate-800 text-white font-black rounded-xl btn-3d border-slate-900 shadow-md">CONCLUIR REVIS√ÉO</button>
        </div>
    </div>

    <div id="countdown-overlay" class="fixed inset-0 bg-law-primary z-[400] hidden flex-col items-center justify-center">
        <h2 class="text-white font-black text-2xl mb-8 uppercase tracking-widest text-center px-8">Preparando<br>Simulado</h2>
        <div id="countdown-number" class="text-[150px] font-black text-white" style="text-shadow: 0 10px 30px rgba(0,0,0,0.3);">3</div>
        <div class="w-16 h-1 bg-white/30 rounded-full mt-10 overflow-hidden"><div class="w-full h-full bg-law-action animate-pulse"></div></div>
    </div>

    <div id="novidades-modal" class="fixed inset-0 bg-black/50 z-[150] hidden flex-col justify-end">
        <div class="bg-white rounded-t-[2rem] p-6 pb-12 animate-[slideUp_0.3s_ease-out]">
            <div class="flex justify-between items-center mb-6">
                <h2 class="text-2xl font-black text-slate-800">Pr√≥ximos Recursos üöÄ</h2>
                <button onclick="document.getElementById('novidades-modal').classList.add('hidden')" class="w-8 h-8 bg-slate-100 rounded-full text-slate-500"><i class="fas fa-times"></i></button>
            </div>
            <div class="space-y-4">
                <div class="flex items-center gap-4 bg-purple-50 p-4 rounded-2xl border border-purple-100">
                    <div class="text-3xl">ü§ñ</div><div><h4 class="font-black text-purple-900">IA Monitora</h4><p class="text-xs text-purple-700">Tire d√∫vidas t√©cnicas 24h.</p></div>
                </div>
                <div class="flex items-center gap-4 bg-blue-50 p-4 rounded-2xl border border-blue-100">
                    <div class="text-3xl overflow-hidden rounded-full w-10 h-10 flex items-center justify-center">üë¥</div>
                    <div><h4 class="font-black text-blue-900">Hist√≥rias do Direito</h4><p class="text-xs text-blue-700">Casos pr√°ticos com o Prof. Joaquim.</p></div>
                </div>
            </div>
        </div>
    </div>

    <div id="paywall-modal" class="fixed inset-0 bg-law-primary z-[200] hidden flex-col overflow-y-auto">
        <button onclick="document.getElementById('paywall-modal').classList.add('hidden')" class="absolute top-6 right-6 text-white text-2xl bg-black/20 w-10 h-10 rounded-full"><i class="fas fa-times"></i></button>
        <div class="p-8 pt-20 text-center">
            <span class="bg-law-action text-white text-[10px] font-black px-3 py-1 rounded-full uppercase tracking-widest shadow-lg">Plano Premium</span>
            <h2 class="text-4xl font-black text-white mt-6 mb-2">Preparat√≥rio OAB 1¬™ Fase</h2>
            <p class="text-green-100 font-medium mb-8">Estruture sua base agora para garantir a aprova√ß√£o futura.</p>
            
            <div class="bg-white rounded-3xl p-6 text-left shadow-2xl relative">
                <div class="absolute -top-4 right-6 bg-red-500 text-white text-[10px] font-black px-2 py-1 rounded shadow-md transform rotate-3">VAGAS LIMITADAS</div>
                <div class="flex items-end gap-1 mb-6 border-b border-gray-100 pb-4">
                    <span class="text-sm font-bold text-slate-400">R$</span><span class="text-5xl font-black text-law-primary">129</span><span class="text-sm font-bold text-slate-400">,90 /m√™s</span>
                </div>
                <ul class="space-y-4 mb-8">
                    <li class="flex gap-3 items-start"><i class="fas fa-check-circle text-law-action mt-0.5 text-lg"></i><span class="text-sm font-bold text-slate-600">Simulados oficiais de anos anteriores.</span></li>
                    <li class="flex gap-3 items-start"><i class="fas fa-check-circle text-law-action mt-0.5 text-lg"></i><span class="text-sm font-bold text-slate-600">Proje√ß√£o de nota calculada por IA.</span></li>
                    <li class="flex gap-3 items-start"><i class="fas fa-check-circle text-law-action mt-0.5 text-lg"></i><span class="text-sm font-bold text-slate-600">Acesso priorit√°rio a d√∫vidas e mentoria.</span></li>
                </ul>
                <button onclick="alert('Redirecionando para o Checkout de Pagamento...')" class="w-full py-5 bg-law-action text-white font-black rounded-2xl btn-3d border-orange-700 text-lg">ASSINAR PLANO</button>
            </div>
        </div>
    </div>

    <div id="ios-prompt" class="fixed bottom-6 left-4 right-4 bg-white p-5 rounded-3xl shadow-2xl z-[500] hidden border-2 border-law-primary transform transition-transform translate-y-full duration-300">
        <div class="flex items-start gap-4">
            <div class="w-12 h-12 bg-law-primary text-white rounded-2xl flex items-center justify-center text-2xl flex-shrink-0 shadow-md">
                <i class="fas fa-owl"></i>
            </div>
            <div class="flex-1">
                <h3 class="font-black text-slate-800 text-base leading-tight">Instalar Aplicativo</h3>
                <p class="text-xs text-slate-500 mt-1 font-medium">Toque no √≠cone <i class="fas fa-external-link-square-alt mx-1 text-slate-800"></i> de compartilhamento abaixo e selecione <b>"Adicionar √† Tela de In√≠cio"</b>.</p>
            </div>
            <button onclick="closeIOSPrompt()" class="text-slate-300 hover:text-slate-500"><i class="fas fa-times text-xl"></i></button>
        </div>
        <div class="absolute -bottom-3 left-1/2 -translate-x-1/2 w-5 h-5 bg-white border-b-2 border-r-2 border-law-primary transform rotate-45"></div>
    </div>

    <script>
        function doLogin() {
            document.getElementById('login-screen').classList.add('hidden');
            document.getElementById('checkin-modal').classList.remove('hidden');
            document.getElementById('checkin-modal').classList.add('flex');
        }

        function answerCheckin(response) {
            document.getElementById('checkin-modal').classList.add('hidden');
            document.getElementById('main-app').classList.remove('hidden');
            if(response === 'presente') playSound('sfx-success');
            else navigate('faltas');
        }

        function navigate(screenId) {
            document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
            document.getElementById('screen-' + screenId).classList.add('active');
            
            document.querySelectorAll('.nav-btn').forEach(btn => {
                if(btn.dataset.target === screenId) btn.classList.replace('text-slate-400', 'text-law-primary');
                else btn.classList.replace('text-law-primary', 'text-slate-400');
            });
            window.scrollTo(0, 0);
        }

        function openDeepScreen(id) { document.getElementById(id).classList.add('open'); }
        function closeDeepScreen(id) { document.getElementById(id).classList.remove('open'); }
        function openPaywall() { document.getElementById('paywall-modal').classList.remove('hidden'); document.getElementById('paywall-modal').classList.add('flex'); }

        function playSound(id) {
            try { const audio = document.getElementById(id); audio.currentTime = 0; audio.play().catch(e => console.log("√Åudio bloqueado")); } 
            catch(e) {}
        }

        const questoes = [
            { q: "Qual √© a ess√™ncia principal de um contrato?", o: ["Uma declara√ß√£o unilateral de vontade.", "Um neg√≥cio jur√≠dico bilateral.", "Um ato il√≠cito com consequ√™ncias legais."], a: 1 },
            { q: "No Brasil, qual modalidade da Teoria da Agni√ß√£o √© a regra geral?", o: ["Apenas a Declara√ß√£o da vontade.", "A Recep√ß√£o pelo destinat√°rio.", "A Expedi√ß√£o da resposta (Art. 434)."], a: 2 },
            { q: "Qual das op√ß√µes abaixo N√ÉO √© considerada uma exce√ß√£o √† regra da Expedi√ß√£o?", o: ["Retrata√ß√£o que chega junto ou antes.", "Contratos de alto valor comercial.", "Atraso na chegada da resposta."], a: 1 },
            { q: "A Nulidade de um contrato (Art. 166) protege qual tipo de interesse?", o: ["Apenas o interesse da parte prejudicada.", "A Ordem P√∫blica (interesse geral).", "Apenas o interesse financeiro das partes."], a: 1 },
            { q: "A Anulabilidade (Art. 171) pode ser corrigida com o tempo?", o: ["Sim, o erro pode convalescer no prazo legal.", "N√£o, o erro n√£o prescreve nunca.", "Depende apenas do valor estipulado no contrato."], a: 0 },
            { q: "Qual √© a defini√ß√£o correta para Evic√ß√£o?", o: ["Descobrir um defeito oculto no produto adquirido.", "Perder a posse de um bem por decis√£o judicial anterior.", "Desistir do contrato antes de assinar."], a: 1 }
        ];
        
        let currentQ = 0;
        let selectedOption = null;

        function initQuiz() {
            currentQ = 0;
            document.getElementById('quiz-success').classList.add('hidden');
            document.getElementById('quiz-container').classList.remove('hidden');
            document.getElementById('quiz-container').classList.add('flex');
            renderQuestion();
        }

        function renderQuestion() {
            selectedOption = null;
            document.getElementById('quiz-progress').style.width = ((currentQ / questoes.length) * 100) + '%';
            document.getElementById('quiz-question').innerText = questoes[currentQ].q;
            
            const btn = document.getElementById('quiz-btn');
            btn.className = "w-full py-4 bg-slate-200 text-slate-400 font-black rounded-xl btn-3d pointer-events-none mt-4";
            btn.innerText = "CONFIRMAR RESPOSTA";
            btn.onclick = checkAnswer;

            let html = '';
            questoes[currentQ].o.forEach((opt, idx) => {
                html += `<button onclick="selectOption(this, ${idx})" class="quiz-opt w-full text-left p-4 rounded-xl border-2 border-slate-200 font-bold text-slate-600 transition-all hover:bg-slate-50">${opt}</button>`;
            });
            document.getElementById('quiz-options').innerHTML = html;
        }

        function selectOption(el, idx) {
            document.querySelectorAll('.quiz-opt').forEach(b => { b.classList.remove('border-law-primary', 'bg-green-50', 'text-law-primary'); b.classList.add('border-slate-200', 'text-slate-600'); });
            el.classList.remove('border-slate-200', 'text-slate-600');
            el.classList.add('border-law-primary', 'bg-green-50', 'text-law-primary');
            selectedOption = idx;
            
            const btn = document.getElementById('quiz-btn');
            btn.classList.remove('bg-slate-200', 'text-slate-400', 'pointer-events-none');
            btn.classList.add('bg-law-primary', 'text-white', 'border-[#024a35]');
        }

        function checkAnswer() {
            const correctIdx = questoes[currentQ].a;
            const optionsArr = document.querySelectorAll('.quiz-opt');
            
            if(selectedOption === correctIdx) {
                playSound('sfx-success');
                optionsArr[selectedOption].classList.add('correct-answer');
                
                const btn = document.getElementById('quiz-btn');
                btn.className = "w-full py-4 bg-green-500 text-white font-black rounded-xl btn-3d border-green-700 mt-4";
                btn.innerText = "AVAN√áAR";
                btn.onclick = nextQuestion;
            } else {
                playSound('sfx-error');
                const wrongBtn = optionsArr[selectedOption];
                wrongBtn.classList.add('shake-error');
                setTimeout(() => wrongBtn.classList.remove('shake-error'), 500);
            }
        }

        function nextQuestion() {
            currentQ++;
            if(currentQ < questoes.length) {
                renderQuestion();
            } else {
                document.getElementById('quiz-container').classList.add('hidden');
                document.getElementById('quiz-container').classList.remove('flex');
                document.getElementById('quiz-success').classList.remove('hidden');
                document.getElementById('quiz-success').classList.add('flex');
                document.getElementById('quiz-progress').style.width = '100%';
                shootConfetti();
                playSound('sfx-success');
            }
        }

        function shootConfetti() {
            const colors = ['#047857', '#f97316', '#fbbf24', '#3b82f6'];
            for(let i=0; i<50; i++) {
                const conf = document.createElement('div');
                conf.style.position = 'fixed'; conf.style.width = '10px'; conf.style.height = '10px';
                conf.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)];
                conf.style.left = '50%'; conf.style.top = '50%'; conf.style.zIndex = '300';
                conf.style.borderRadius = Math.random() > 0.5 ? '50%' : '0';
                document.body.appendChild(conf);

                const angle = Math.random() * Math.PI * 2;
                const velocity = 10 + Math.random() * 20;
                let x = 0, y = 0, opacity = 1;

                function animateConfetti() {
                    x += Math.cos(angle) * velocity;
                    y += Math.sin(angle) * velocity + 5; 
                    opacity -= 0.02;
                    conf.style.transform = `translate(${x}px, ${y}px) rotate(${x}deg)`;
                    conf.style.opacity = opacity;
                    if(opacity > 0) requestAnimationFrame(animateConfetti);
                    else conf.remove();
                }
                animateConfetti();
            }
        }

        function startCountdown() {
            const overlay = document.getElementById('countdown-overlay');
            const num = document.getElementById('countdown-number');
            overlay.classList.remove('hidden'); overlay.classList.add('flex');
            
            playSound('sfx-countdown');
            
            let count = 3;
            num.innerText = count;
            
            const interval = setInterval(() => {
                count--;
                if(count > 0) {
                    num.innerText = count;
                    num.style.animation = 'none'; num.offsetHeight; num.style.animation = 'popIn 0.5s ease-out';
                } else {
                    clearInterval(interval);
                    num.innerText = "VAI!";
                    setTimeout(() => {
                        overlay.classList.add('hidden'); overlay.classList.remove('flex');
                        alert("Iniciando carregamento do sistema Fiqon...");
                    }, 1000);
                }
            }, 1000);
        }

        // DETECTOR DE iOS
        function checkIOS() {
            const isIOS = /iPad|iPhone|iPod/.test(navigator.userAgent) && !window.MSStream;
            const isStandalone = window.navigator.standalone === true; 
            
            if (isIOS && !isStandalone) {
                const prompt = document.getElementById('ios-prompt');
                prompt.classList.remove('hidden');
                setTimeout(() => { prompt.classList.remove('translate-y-full'); }, 2000);
            }
        }

        function closeIOSPrompt() {
            document.getElementById('ios-prompt').classList.add('translate-y-full');
            setTimeout(() => { document.getElementById('ios-prompt').classList.add('hidden'); }, 300);
        }

        window.addEventListener('load', checkIOS);
    </script>
</body>
</html>
